<div ng-controller="ChatroomController" class="chat room-{{index}}" ng-class="{'newmessage': newmessage, 'visible': visible, 'chat-p2p': 'p2pstate', 'with_pictures': isgroupchat, 'active': active}">
    <div class="chatheader">
        <div class="chatstatusicon" ng-click="deactivateRoom()">
            <i class="fas fa-angle-left"></i>
            <i class="fas fa-comments"></i>
        </div>
        <div class="chatheadertitle">
            <span ng-show="p2pstate" title="{{_('Peer to peer')}}"/><span>
            {{settings.title}} {{id|displayName}}</span>
        </div>
    </div>
    <div class="chatmenu">
        <div class="btn-group">
            <button ng-if="!isgroupchat && roomType!='Conference'" class="btn btn-sm btn-default" title="{{_('Start video call')}}" ng-click="doCall()"><i class="fa fa-phone fa-fw"></i></button>
            <button class="btn btn-sm btn-default btn-fileupload" title="{{_('Upload files')}}"><i class="fas fa-paperclip"></i></button>
        </div>
        <div class="btn-group pull-right">
            <button class="btn btn-sm btn-default" title="{{_('Clear chat')}}" ng-click="doClear()"><i class="fas fa-eraser"></i></button>
        </div>
    </div>
    <div class="chatbody">
        <div class="outputbox">
            <div class="output nicescroll"></div>
        </div>
        <div class="chatbodybottom">
            <div class="typinghint" ng-switch on="peerIsTyping">
                <span ng-switch-when="start"><i class="fas fa-pencil-alt"></i> {{id|displayName}} {{_('is typing...')}}</span>
                <span ng-switch-when="stop"><i class="fas fa-pencil-alt"></i> {{id|displayName}} {{_('has stopped typing...')}}</span>
            </div>
            <div class="inputbox">
                <div>
                    <textarea class="input nicescroll form-control" maxlength="{{maxMessageSize}}" ng-disabled="!(enabled)" on-enter="submit()" ng-model="input" placeholder="{{_('Type here to chat...')}}"/>
                </div>
                <a ng-disabled="!(enabled)" ng-click="submit()" title="{{_('Send')}}" class="btn btn-small btn-info fa fa-play"></a>
            </div>
        </div>
    </div>
</div>
